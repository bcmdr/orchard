<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Orchard</title>

    <!-- # CSS -->
    <!-- Normalize CSS -->
    <link rel="stylesheet" type="text/css" href="https://necolas.github.io/normalize.css/7.0.0/normalize.css" media="screen" />
    <!-- MDL -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" href="./styles/main.css" media="screen" />

    <!-- # JavaScript -->
    <!-- Firebase -->
    <script defer src="/__/firebase/4.7.0/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/4.7.0/firebase-auth.js"></script>
    <script defer src="/__/firebase/4.7.0/firebase-database.js"></script>
    <!-- <script defer src="/__/firebase/4.7.0/firebase-messaging.js"></script> -->
    <!-- <script defer src="/__/firebase/4.7.0/firebase-storage.js"></script> -->
    <!-- initialize the Firebase SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>
    <!-- Vue https://vuejs.org/ -->
    <script defer src="https://cdn.jsdelivr.net/npm/vue"></script>
    <!-- VueFire https://github.com/vuejs/vuefire -->
    <script defer src="https://unpkg.com/vuefire/dist/vuefire.min.js"></script>
    <!-- MDL -->
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
  </head>
  <body>
    <!-- MDL Fixed Header -->
    <!-- Always shows a header, even in smaller screens. -->
    <div v-cloak id="app" class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <header class="mdl-layout__header" role="banner">
        <div class="mdl-layout__header-row">
          <!-- Title -->
          <span v-if="signInStatusKnown" class="mdl-layout-title">
            <span v-if="isSignedIn">
              {{today}}
            </span>
            <span v-else>
              Orchard
            </span>
          </span>
          <!-- Align with spacer -->
          <div class="mdl-layout-spacer"></div>
          <nav class="mdl-navigation">
            <div class="user-area">
              <div v-if="signInStatusKnown">
                <a v-if="isSignedIn" class="mdl-navigation__link">{{user.totalCollectCount}} <i class="material-icons">check_circle</i></a>
                <div v-else>
                  <a class="mdl-navigation__link" style="cursor: pointer" @click="signinGoogle">Sign In With Google</a>
                </div>
              </div>
            </div>
          </nav>
        </div>
      </header>

      <!-- Header Drawer -->
      <div class="mdl-layout__drawer">
        <span class="mdl-layout-title">Orchard</span>
        <nav class="mdl-navigation">
          <div v-if="signInStatusKnown">
            <a v-if="isSignedIn" class="mdl-navigation__link" @click="signoutGoogle">Sign Out</a>
          </div>
        </nav>
      </div>

      <!-- Main Content -->
      <main class="mdl-layout__content">
        <section class="page-content">
          <div v-if="signInStatusKnown">

            <!-- User Fruits (User Signed In) -->
            <div id="user-fruits" v-if="isSignedIn" >
              <div class="mdl-grid">
                <user-fruit
                  v-for="(fruit, index) in fruits"
                  v-bind:key="fruit.id"
                  v-bind:title="fruit.title"
                  v-bind:collect-count="fruit.collectCount"
                  v-on:remove="removeFruit(fruit['.key'])"
                  v-on:increment="incrementCollectCountBy(fruit['.key'], 1)"
                  v-on:decrement="incrementCollectCountBy(fruit['.key'], -1)"
                ></user-fruit>
              </div>
              <!-- New Fruit -->
              <div v-if="readyToDisplayFruits" class="newFruitFormWrapper">
                <div class="mdl-grid">
                  <div class="mdl-cell mdl-cell--12-col">
                    <form
                      v-on:submit.prevent="addNewFruit">
                      <input
                        id="newFruitInput"
                        v-model="newFruit.title"
                        placeholder="New Daily Goal"
                      >
                      <input type="submit" value="Grow">
                    </form>
                  </div>
                </div>
              </div>
            </div>

            <!-- Demo Fruits (User Not Signed In) -->
            <div v-else>
              <div v-cloak class="demo-fruits">
                <div class="mdl-grid">
                  <demo-fruit
                    v-for="fruit in demoFruits"
                    v-bind:key="fruit.id"
                    v-bind:title="fruit.title"
                    v-bind:description="fruit.description"
                  ></demo-fruit>
                </div>
              </div>
            </div> <!-- end user not signed in -->

          </div> <!-- end if sign in status known -->
        </section> <!-- end mdl page content -->
      </main> <!-- end main content -->
    </div> <!-- end #app -->


    <!-- Vue Model -->
    <script src="./scripts/AppVM.js"></script>

    <!-- Content Loaded and Ready -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {

        // Prepare and Mount Vue Models
        loadAppVM();

      });
    </script>
  </body>
</html>
